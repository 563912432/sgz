(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7fa1737e"],{"0a49":function(t,e,i){var a=i("9b43"),n=i("626a"),r=i("4bf8"),s=i("9def"),o=i("cd1c");t.exports=function(t,e){var i=1==t,l=2==t,c=3==t,u=4==t,d=6==t,p=5==t||d,f=e||o;return function(e,o,m){for(var g,h,v=r(e),b=n(v),y=a(o,m,3),_=s(b.length),w=0,D=i?f(e,_):l?f(e,0):void 0;_>w;w++)if((p||w in b)&&(g=b[w],h=y(g,w,v),t))if(i)D[w]=h;else if(h)switch(t){case 3:return!0;case 5:return g;case 6:return w;case 2:D.push(g)}else if(u)return!1;return d?-1:c||u?u:D}}},"0a9e":function(t,e,i){"use strict";var a=i("7954"),n=i.n(a);n.a},1169:function(t,e,i){var a=i("2d95");t.exports=Array.isArray||function(t){return"Array"==a(t)}},"11e9":function(t,e,i){var a=i("52a7"),n=i("4630"),r=i("6821"),s=i("6a99"),o=i("69a8"),l=i("c69a"),c=Object.getOwnPropertyDescriptor;e.f=i("9e1e")?c:function(t,e){if(t=r(t),e=s(e,!0),l)try{return c(t,e)}catch(i){}if(o(t,e))return n(!a.f.call(t,e),t[e])}},"20d6":function(t,e,i){"use strict";var a=i("5ca1"),n=i("0a49")(6),r="findIndex",s=!0;r in[]&&Array(1)[r](function(){s=!1}),a(a.P+a.F*s,"Array",{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")(r)},2953:function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"adminIndex"},[i("div",{staticClass:"font-13 mb-12 bold flex flex-justify-space-between flex-align-center"},[i("span",[t._v("全盘账管理")]),i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.addCompany}},[t._v("企业新增")])],1),t.companyData.length>0?i("div",[i("div",{staticClass:"header flex flex-justify-space-between font-13"},[i("span",{staticClass:"bold"},[i("span",[t._v("企业名称：")]),i("span",[t._v(t._s(t.companyData[0]["trade_name"]))])]),i("span",[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.subject(t.companyData[0].id)}}},[t._v("科目设置")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.addBusiness(t.companyData[0].id)}}},[t._v("新增业务")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.toSaveAnswer(t.companyData[0].id)}}},[t._v("答案绑定")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.editCompany(t.companyData[0])}}},[t._v("编辑")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.delCompany(t.companyData[0].id)}}},[t._v("删除")])],1)]),i("div",[i("el-table",{staticClass:"mb-12",staticStyle:{width:"100%"},attrs:{size:"mini",data:t.companyData[0]["business"],border:"",fit:"","highlight-current-row":""}},[i("el-table-column",{attrs:{label:"业务摘要",width:"",align:""},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n            "+t._s(i.abstract)+"\n          ")]}}],null,!1,1339650239)}),i("el-table-column",{attrs:{label:"业务内容",width:"",align:""},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.row;return[t._v("\n            "+t._s(i.content)+"\n          ")]}}],null,!1,2128899478)}),i("el-table-column",{attrs:{label:"操作",width:"220",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.editBusiness(a,t.companyData[0]["id"])}}},[t._v("\n              编辑\n            ")]),i("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(e){return t.delBusiness(a,t.companyData[0]["id"])}}},[t._v("\n              删除\n            ")])]}}],null,!1,2582318464)})],1),i("el-pagination",{staticClass:"text-center",attrs:{small:"",layout:"prev, pager, next","page-size":t.pageQuery.page_size,"current-page":t.pageQuery.page,total:t.total},on:{"current-change":t.changePageIndex}})],1)]):i("div",{staticClass:"text-center font-13 col-9"},[t._v("\n    暂无数据\n  ")]),t.dialogSubjectVisible?i("div",[i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"subject-dialog",attrs:{width:"450px",modal:!1,"close-on-click-modal":!1,title:"科目管理",visible:t.dialogSubjectVisible},on:{"update:visible":function(e){t.dialogSubjectVisible=e},dragDialog:t.handleSubjectDrag}},[i("div",{ref:"subjectDiv"},[i("Subject",{attrs:{"company-id":t.companyId,data:t.subjectData}})],1)])],1):t._e(),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"company-dialog",attrs:{width:"900px",modal:!1,"close-on-click-modal":!1,title:"企业管理",visible:t.dialogCompanyVisible},on:{"update:visible":function(e){t.dialogCompanyVisible=e},dragDialog:t.handleCompanyDrag}},[i("div",{staticStyle:{height:"600px","overflow-y":"auto",padding:"20px"}},[i("el-form",{ref:"companyForm",attrs:{rules:t.companyRules,model:t.companyFormData,"label-position":"left","label-width":"85px"}},[i("el-form-item",{attrs:{label:"企业名称",prop:"trade_name"}},[i("el-input",{attrs:{size:"mini"},model:{value:t.companyFormData.trade_name,callback:function(e){t.$set(t.companyFormData,"trade_name",e)},expression:"companyFormData.trade_name"}})],1),i("el-form-item",{attrs:{label:"背景信息"}},[i("quill-editor",{attrs:{options:t.editorOption},model:{value:t.companyFormData.material,callback:function(e){t.$set(t.companyFormData,"material",e)},expression:"companyFormData.material"}})],1),i("el-form-item",{attrs:{label:"期初余额表"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","file-list":t.listQiChu,"list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1)],1)],1),i("div",{ref:"divCompany",staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.saveCompany("companyForm")}}},[t._v("\n        确定\n      ")]),i("el-button",{attrs:{size:"mini",plain:""},on:{click:function(e){t.dialogCompanyVisible=!1}}},[t._v("\n        返回\n      ")])],1)]),t.dialogBusinessVisible?i("div",[i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"business-dialog",attrs:{width:"900px",modal:!1,"close-on-click-modal":!1,title:"业务管理",visible:t.dialogBusinessVisible},on:{"update:visible":function(e){t.dialogBusinessVisible=e},dragDialog:t.handleBusinessDrag}},[i("div",{ref:"businessDiv"},[i("Business",{attrs:{"company-id":t.companyId,"business-data":t.businessData},on:{save:t.saveBusiness}})],1)])],1):t._e()],1)},n=[],r=(i("ac6a"),i("a481"),i("6762"),i("2fdb"),{bind:function(t,e,i){var a=t.querySelector(".el-dialog__header"),n=t.querySelector(".el-dialog");a.style.cssText+=";cursor:move;",n.style.cssText+=";top:0px;";var r=function(){return window.document.currentStyle?function(t,e){return t.currentStyle[e]}:function(t,e){return getComputedStyle(t,!1)[e]}}();a.onmousedown=function(t){var e=t.clientX-a.offsetLeft,s=t.clientY-a.offsetTop,o=n.offsetWidth,l=n.offsetHeight,c=document.body.clientWidth,u=document.body.clientHeight,d=n.offsetLeft,p=c-n.offsetLeft-o,f=n.offsetTop,m=u-n.offsetTop-l,g=r(n,"left"),h=r(n,"top");g.includes("%")?(g=+document.body.clientWidth*(+g.replace(/\%/g,"")/100),h=+document.body.clientHeight*(+h.replace(/\%/g,"")/100)):(g=+g.replace(/\px/g,""),h=+h.replace(/\px/g,"")),document.onmousemove=function(t){var a=t.clientX-e,r=t.clientY-s;-a>d?a=-d:a>p&&(a=p),-r>f?r=-f:r>m&&(r=m),n.style.cssText+=";left:".concat(a+g,"px;top:").concat(r+h,"px;"),i.child.$emit("dragDialog")},document.onmouseup=function(t){document.onmousemove=null,document.onmouseup=null}}}}),s=function(t){t.directive("el-drag-dialog",r)};window.Vue&&(window["el-drag-dialog"]=r,Vue.use(s)),r.install=s;var o=r,l=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"subject"},[i("div",{staticStyle:{height:"300px","overflow-y":"auto"}},[i("el-tree",{attrs:{data:t.subjectData,"node-key":"id","default-expand-all":"","expand-on-click-node":!1},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.node,n=e.data;return i("span",{staticClass:"custom-tree-node"},[i("span",[t._v(t._s(n.title))]),i("span",[i("i",{staticClass:"el-icon-circle-plus-outline tree-icon-blue ml-3",style:"1"===n.level?"margin-right:34px":"",on:{click:function(){return t.addSubject(n)}}}),"1"!==n.level?i("i",{staticClass:"el-icon-edit-outline tree-icon-orange ml-3",on:{click:function(e){return t.editSubject(n)}}}):t._e(),"1"!==n.level?i("i",{staticClass:"el-icon-circle-close tree-icon-red ml-3",on:{click:function(e){return t.delSubject(a,n)}}}):t._e()])])}}])})],1),i("div",{staticClass:"text-right",staticStyle:{padding:"10px"}},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.save}},[t._v("保存")])],1),i("el-dialog",{directives:[{name:"el-drag-dialog",rawName:"v-el-drag-dialog"}],staticClass:"subject-detail-dialog",attrs:{width:"400px",modal:!1,"close-on-click-modal":!1,title:"科目管理",visible:t.dialogSubjectVisible},on:{"update:visible":function(e){t.dialogSubjectVisible=e},dragDialog:t.handleSubjectDrag}},[i("el-form",{ref:"subjectForm",attrs:{rules:t.subjectRules,model:t.subjectFormData,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"科目名称",prop:"title"}},[i("el-input",{attrs:{clearable:"",size:"mini"},model:{value:t.subjectFormData.title,callback:function(e){t.$set(t.subjectFormData,"title",e)},expression:"subjectFormData.title"}})],1)],1),i("div",{ref:"divSubject",staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.saveAddSubject("subjectForm")}}},[t._v("\n        确定\n      ")]),i("el-button",{attrs:{size:"small",plain:""},on:{click:function(e){t.dialogSubjectVisible=!1}}},[t._v("\n        返回\n      ")])],1)],1)],1)},c=[],u=(i("20d6"),i("c5f6"),{name:"Subject",directives:{elDragDialog:o},props:{companyId:{type:Number,required:!0,defaults:0},data:{type:Array,required:!0,defaults:[]}},data:function(){return{subjectData:[],dialogSubjectVisible:!1,subjectFormData:{id:"",title:"",parent_id:"",level:""},subjectRules:{title:[{required:!0,message:"请填写科目名称",trigger:"blur"}]},handleData:[],handleIndex:0,resultData:[],resultId:0}},computed:{basicKeMu:function(){return this.$store.state.basicKeMu}},created:function(){this.initData()},methods:{initData:function(){var t=this;this.subjectData=this.$store.state["basicKeMu"],this.data.length>0&&this.subjectData.forEach(function(e){var i=t.getTree(t.data,e.id);i.length>0&&t.$set(e,"children",i)}),this.resultId=this.subjectData.concat(this.data).length+1,this.resetBasicKeMu()},getTree:function(t,e){var i=this,a=[];return t.forEach(function(n){if(n.parent_id===e){var r={id:n.id,title:n.title,parent_id:n.parent_id,level:n.level,children:i.getTree(t,n.id)};a.push(r)}}),a},addSubject:function(t){var e=this;this.subjectFormData={id:"",title:"",parent_id:"",level:""},this.handleData=t,this.subjectData.forEach(function(i,a){i===t&&(e.handleIndex=a)}),this.dialogSubjectVisible=!0},editSubject:function(t){this.subjectFormData=t,this.handleData=t,this.dialogSubjectVisible=!0},saveAddSubject:function(t){var e=this;this.$refs[t].validate(function(t){if(t){if(e.subjectFormData.id&&""!==e.subjectFormData.id)e.$set(e.handleData,"title",e.subjectFormData.title);else{var i={id:e.resultId,title:e.subjectFormData.title,parent_id:e.handleData.id,level:parseInt(e.handleData.level)+1};e.handleData.children||e.$set(e.handleData,"children",[]),e.handleData.children.push(i),e.resultId+=1}e.dialogSubjectVisible=!1}})},save:function(){var t=this;this.resultData=[],this.subjectData.forEach(function(e){e.children&&t.handleChildren(e.children)}),window.axios.post("".concat(window.adminHost,"/admin/manual/company/add"),{id:this.companyId,subject:JSON.stringify(this.resultData)}).then(function(e){var i=e.data;i.error_code?t.$message.error("保存失败"):t.$message.success("保存成功")}).catch(function(t){console.log(t)})},delSubject:function(t,e){this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var i=t.parent,a=i.data.children||i.data,n=a.findIndex(function(t){return t.id===e.id});a.splice(n,1)}).catch(function(){console.log("cancel")})},handleSubjectDrag:function(){this.$refs["divSubject"].blur()},handleChildren:function(t){var e=this;if(!(t&&t.length>0))return!1;t.forEach(function(t){e.resultData.push({id:t.id,title:t.title,parent_id:t.parent_id,level:t.level}),e.handleChildren(t.children)})},resetBasicKeMu:function(){this.$store.commit("SAVE_BASIC_KE_MU",this.returnBasicKeMu())},returnBasicKeMu:function(){return[{id:1,title:"库存现金",parent_id:"0",level:"1"},{id:2,title:"银行存款",parent_id:"0",level:"1"},{id:3,title:"应收票据",parent_id:"0",level:"1"},{id:4,title:"应收账款",parent_id:"0",level:"1"},{id:5,title:"其他应收款",parent_id:"0",level:"1"},{id:6,title:"原材料",parent_id:"0",level:"1"},{id:7,title:"库存商品",parent_id:"0",level:"1"},{id:8,title:"周转材料",parent_id:"0",level:"1"},{id:9,title:"固定资产",parent_id:"0",level:"1"},{id:10,title:"累计折旧",parent_id:"0",level:"1"},{id:11,title:"短期借款",parent_id:"0",level:"1"},{id:12,title:"应付票据",parent_id:"0",level:"1"},{id:13,title:"应付账款",parent_id:"0",level:"1"},{id:14,title:"应付职工薪酬",parent_id:"0",level:"1"},{id:15,title:"应交税费",parent_id:"0",level:"1"},{id:16,title:"应付利润",parent_id:"0",level:"1"},{id:17,title:"其他应付款",parent_id:"0",level:"1"},{id:18,title:"盈余公积",parent_id:"0",level:"1"},{id:19,title:"本年利润",parent_id:"0",level:"1"},{id:20,title:"利润分配",parent_id:"0",level:"1"},{id:21,title:"生产成本",parent_id:"0",level:"1"},{id:22,title:"制造费用",parent_id:"0",level:"1"},{id:23,title:"主营业务收入",parent_id:"0",level:"1"},{id:24,title:"其他业务收入",parent_id:"0",level:"1"},{id:25,title:"营业外收入",parent_id:"0",level:"1"},{id:26,title:"主营业务成本",parent_id:"0",level:"1"},{id:27,title:"税金及附加",parent_id:"0",level:"1"},{id:28,title:"销售费用",parent_id:"0",level:"1"},{id:29,title:"管理费用",parent_id:"0",level:"1"},{id:30,title:"财务费用",parent_id:"0",level:"1"},{id:31,title:"所得税费用",parent_id:"0",level:"1"},{id:32,title:"营业外支出",parent_id:"0",level:"1"},{id:33,title:"实收资本",parent_id:"0",level:"1"},{id:34,title:"应付利息",parent_id:"0",level:"1"},{id:35,title:"其他业务成本",parent_id:"0",level:"1"}]}}}),d=u,p=(i("2c7b"),i("6a3f"),i("2877")),f=Object(p["a"])(d,l,c,!1,null,"9f8d22c8",null),m=f.exports,g=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"business"},[i("el-form",{ref:"businessForm",attrs:{rules:t.rules,model:t.formData,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"业务摘要",prop:"abstract"}},[i("el-input",{attrs:{clearable:"",size:"mini"},model:{value:t.formData.abstract,callback:function(e){t.$set(t.formData,"abstract",e)},expression:"formData.abstract"}})],1),i("el-form-item",{attrs:{label:"业务说明",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请填写业务说明",clearable:"",size:"mini"},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}})],1),i("el-form-item",{attrs:{label:"原始资料上传",prop:"sort"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","file-list":t.fileList,"list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),i("el-form-item",{attrs:{label:"原始资料名称",prop:""}},[t.formData.resource&&t.formData.resource.length>0?i("div",t._l(t.formData.resource,function(e,a){return i("div",{key:a,staticClass:"flex flex-align-center"},[i("el-input",{attrs:{placeholder:"请填写原始资料名称",clearable:"",size:"mini"},model:{value:e.name,callback:function(i){t.$set(e,"name",i)},expression:"item.name"}}),i("span",{staticClass:"ml-5"},[i("el-button",{attrs:{size:"mini",plain:""},on:{click:function(e){return t.delMaterial(a)}}},[t._v("删除")])],1)],1)}),0):t._e(),i("div",[i("el-button",{attrs:{size:"mini",plain:"",icon:"el-icon-plus"},on:{click:t.addMaterial}},[t._v("添加一条原始资料")])],1)]),i("el-form-item",{attrs:{label:"文字解析",prop:"content"}},[i("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请填写文字解析",clearable:"",size:"mini"},model:{value:t.formData.textParse,callback:function(e){t.$set(t.formData,"textParse",e)},expression:"formData.textParse"}})],1),i("el-form-item",{attrs:{label:"视频解析",prop:"sort"}},[i("el-upload",{staticClass:"upload-demo",attrs:{action:"https://jsonplaceholder.typicode.com/posts/","list-type":"picture"}},[i("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")]),i("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[t._v("只能上传jpg/png文件，且不超过500kb")])],1)],1),i("el-form-item",[i("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.saveBusiness("businessForm")}}},[t._v("保存")])],1)],1)],1)},h=[],v={name:"Business",props:{companyId:{type:Number,required:!0,defaults:0},businessData:{type:Object,required:!0,defaults:{}}},data:function(){return{formData:{abstract:"",content:"",resource:[{url:"",name:""}],textParse:"",videoParse:""},imageUrl:[],rules:{abstract:[{required:!0,message:"请填写业务摘要",trigger:"blur"}],number:[{required:!0,message:"请填写编号",trigger:"blur"}]},fileList:[]}},created:function(){this.initData()},methods:{initData:function(){"{}"!==JSON.stringify(this.businessData)?(this.formData={id:this.businessData.id,abstract:this.businessData.abstract,content:this.businessData.content,resource:JSON.parse(this.businessData.resource),textParse:this.businessData.textParse,videoParse:this.businessData.videoParse},this.formData.resource.length>0&&(this.fileList=this.formData.resource)):this.formData={abstract:"",content:"",resource:[{url:"",name:""}],textParse:"",videoParse:""}},addMaterial:function(){this.formData.resource.push({url:"",name:""})},delMaterial:function(t){this.formData.resource.length>1?this.formData.resource.splice(t,1):this.$message.warning("至少保留一条原始资料")},saveBusiness:function(t){var e=this;this.$refs[t].validate(function(t){if(t){var i={trade_id:e.companyId,abstract:e.formData.abstract,content:e.formData.content,resource:JSON.stringify(e.formData.resource),textParse:e.formData.textParse,videoParse:e.formData.videoParse};e.formData.id&&(i.id=e.formData.id),window.axios.post("".concat(window.adminHost,"/admin/manual/business"),i).then(function(t){var i=t.data;i.error_code?e.$message.error("保存失败"):(e.$message.success("保存成功"),e.$emit("save"))}).catch(function(t){console.log(t)})}})}}},b=v,y=(i("0a9e"),Object(p["a"])(b,g,h,!1,null,"95ae5d26",null)),_=y.exports,w=i("953d");const D={watcher:{},active:null,on:function(t,e){this.watcher[t]||(this.watcher[t]=e)},emit:function(t,e=1){this.active=this.watcher[t],1===e&&x()}};class j{constructor(t,e={}){this.id=Math.random(),this.quill=t,this.quill.id=this.id,this.config=e,this.file="",this.imgURL="",t.root.addEventListener("paste",this.pasteHandle.bind(this),!1),t.root.addEventListener("drop",this.dropHandle.bind(this),!1),t.root.addEventListener("dropover",function(t){t.preventDefault()},!1),this.cursorIndex=0,D.on(this.id,this)}pasteHandle(t){D.emit(this.quill.id,0);let e,i,a,n=t.clipboardData,r=0;if(n){if(e=n.items,!e)return;for(i=e[0],a=n.types||[];r<a.length;r++)if("Files"===a[r]){i=e[r];break}if(i&&"file"===i.kind&&i.type.match(/^image\//i)){this.file=i.getAsFile();let t=this;if(t.config.size&&t.file.size>=1024*t.config.size*1024)return void(t.config.sizeError&&t.config.sizeError());this.config.action}}}dropHandle(t){D.emit(this.quill.id,0);const e=this;t.preventDefault(),e.config.size&&e.file.size>=1024*e.config.size*1024?e.config.sizeError&&e.config.sizeError():(e.file=t.dataTransfer.files[0],this.config.action?e.uploadImg():e.toBase64())}toBase64(){const t=this,e=new FileReader;e.onload=e=>{t.imgURL=e.target.result,t.insertImg()},e.readAsDataURL(t.file)}uploadImg(){const t=this;t.quillLoading;let e=t.config,i=new FormData;i.append(e.name,t.file),e.editForm&&e.editForm(i);let a=new XMLHttpRequest;a.open("post",e.action,!0),e.headers&&e.headers(a),e.change&&e.change(a,i),a.onreadystatechange=function(){if(4===a.readyState)if(200===a.status){let i=JSON.parse(a.responseText);t.imgURL=e.response(i),D.active.uploadSuccess(),t.insertImg(),t.config.success&&t.config.success()}else t.config.error&&t.config.error(),D.active.uploadError()},a.upload.onloadstart=function(t){D.active.uploading(),e.start&&e.start()},a.upload.onprogress=function(t){let e=(t.loaded/t.total*100|0)+"%";D.active.progress(e)},a.upload.onerror=function(t){D.active.uploadError(),e.error&&e.error()},a.upload.onloadend=function(t){e.end&&e.end()},a.send(i)}insertImg(){const t=D.active;t.quill.insertEmbed(D.active.cursorIndex,"image",t.imgURL),t.quill.update(),t.quill.setSelection(t.cursorIndex+1)}progress(t){t="[uploading"+t+"]",D.active.quill.root.innerHTML=D.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,t)}uploading(){let t=(D.active.quill.getSelection()||{}).index||D.active.quill.getLength();D.active.cursorIndex=t,D.active.quill.insertText(D.active.cursorIndex,"[uploading...]",{color:"red"},!0)}uploadError(){D.active.quill.root.innerHTML=D.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"[upload error]")}uploadSuccess(){D.active.quill.root.innerHTML=D.active.quill.root.innerHTML.replace(/\[uploading.*?\]/,"")}}function x(){let t=document.querySelector(".quill-image-input");null===t&&(t=document.createElement("input"),t.setAttribute("type","file"),t.classList.add("quill-image-input"),t.style.display="none",t.addEventListener("change",function(){let e=D.active;e.file=t.files[0],t.value="",e.config.size&&e.file.size>=1024*e.config.size*1024?e.config.sizeError&&e.config.sizeError():e.config.action?e.uploadImg():e.toBase64()}),document.body.appendChild(t)),t.click()}w["Quill"].register("modules/ImageExtend",j);var S={name:"AdminIndex",components:{Business:_,Subject:m},directives:{elDragDialog:o},data:function(){var t=this;return{activeName:"first",companyData:[],subjectData:[],businessData:{},dialogSubjectVisible:!1,companyId:0,dialogCompanyVisible:!1,companyRules:{trade_name:[{required:!0,message:"请填写企业名称",trigger:"blur"}]},companyFormData:{trade_name:"",material:"",qi_chu:""},pageQuery:{page:1,page_size:1},total:0,dialogBusinessVisible:!1,listQiChu:[],editorOption:{modules:{ImageExtend:{loading:!0,name:"file",size:1,action:window.host+"uploadEditorImg",response:function(e){if(1===e.status)return e.resultData;t.$message.error(e.info)},sizeError:function(){t.$message.error("图片尺寸最大为1M")},headers:function(e){e.setRequestHeader("token",t.$store.state.access_token_teacher)}},toolbar:{container:["bold","italic","underline",{script:"sub"},{script:"super"},"clean","image"],handlers:{image:function(){D.emit(this.quill.id)}}}}}}},created:function(){this.initData()},methods:{initData:function(){var t=this;window.axios.post("".concat(window.adminHost,"/admin/manual/company/list?page=").concat(this.pageQuery.page,"&&page_size=").concat(this.pageQuery.page_size)).then(function(e){var i=e.data;i.error_code?t.$message.error("请求失败"):(t.companyData=i.data.data,t.total=i.data.total,t.companyData[0]["subject"]&&""!==t.companyData[0]["subject"]?t.subjectData=JSON.parse(t.companyData[0]["subject"]):t.subjectData=[])}).catch(function(t){console.log(t)})},addCompany:function(){var t=this;this.companyFormData={trade_name:"",material:'<p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304102667327.jpg" title="1500255209245050.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304102492960.jpg" title="1500255209203102.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304102419714.jpg" title="1500255209925022.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304731358168.jpg" title="1500255257431719.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304731416762.jpg" title="1500255257394861.jpg"/></p><p><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527304808298965.jpg" title="1500254541330256.jpg" alt="了解三：企业主要税收征收政策.jpg" style="white-space: normal;"/></p><p><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527313849503003.jpg" title="1500254593418550.jpg" alt="了解四：账簿组织概述.jpg" style="white-space: normal;"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527313883602407.jpg" title="1500686362155841.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527313883498343.jpg" title="1500686367688571.jpg"/></p><p style="white-space: normal;"><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527313883234030.jpg" title="1500686374617496.jpg"/></p><p><img src="http://www.wenyunjy.com:8081/Uploads/ueImage/20180526/1527313933589344.jpg" title="1500254873934369.jpg" alt="了解六：会计科目.jpg" style="white-space: normal;"/></p>',qi_chu:JSON.stringify(["/Uploads/ueImage/20181212/1544603457867972.jpg","/Uploads/ueImage/20181212/1544603462375950.jpg","/Uploads/ueImage/20181212/1544603466237929.jpg","/Uploads/ueImage/20181212/1544603473197232.jpg","/Uploads/ueImage/20181212/1544603477389145.jpg"])},this.dialogCompanyVisible=!0,this.$nextTick(function(){t.$refs["companyForm"].clearValidate()})},editCompany:function(t){var e=this;this.companyFormData=Object.assign(t);var i=[];this.companyFormData.qi_chu.length>0&&this.companyFormData.qi_chu.forEach(function(t){i.push({url:"http://www.wenyunjy.com:8081"+t,name:"期初余额表"})}),this.listQiChu=i,this.dialogCompanyVisible=!0,this.$nextTick(function(){e.$refs["companyForm"].clearValidate()})},delCompany:function(t){var e=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.axios.delete("".concat(window.adminHost,"/admin/manual/company/del/").concat(t)).then(function(t){var i=t.data;i.error_code?e.$message.error("删除失败"):(e.$message.success("删除成功"),e.pageQuery.page=e.pageQuery.page-1,e.initData())}).catch(function(t){console.log(t)})}).catch(function(){console.log("cancel")})},subject:function(t){this.companyId=t,this.dialogSubjectVisible=!0},saveCompany:function(t){var e=this;this.$refs[t].validate(function(t){t&&window.axios.post("".concat(window.adminHost,"/admin/manual/company/add"),e.companyFormData).then(function(t){var i=t.data;i.error_code?e.$message.error("保存失败"):(e.$message.success("保存成功"),e.dialogCompanyVisible=!1,e.initData())}).catch(function(t){console.log(t)})})},addBusiness:function(t){this.companyId=t,this.businessData={},this.dialogBusinessVisible=!0},editBusiness:function(t,e){this.companyId=e,this.businessData=t,this.dialogBusinessVisible=!0},delBusiness:function(t,e){var i=this;this.$confirm("确定要删除吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){window.axios.delete("".concat(window.adminHost,"/admin/manual/business/").concat(t.id)).then(function(t){var e=t.data;e.error_code?i.$message.error("删除失败"):(i.$message.success("删除成功"),i.initData())}).catch(function(t){console.log(t)})}).catch(function(){console.log("cancel")})},saveBusiness:function(){this.dialogBusinessVisible=!1,this.initData()},toSaveAnswer:function(t){window.open("/shou_gong_zhang/#/home/".concat(t,"/teacher"))},handleSubjectDrag:function(){this.$refs["subjectDiv"].blur()},handleCompanyDrag:function(){this.$refs["divCompany"].blur()},handleBusinessDrag:function(){this.$refs["businessDiv"].blur()},changePageIndex:function(t){this.pageQuery.page=t,this.initData()}}},I=S,C=(i("6965"),i("ec4d"),Object(p["a"])(I,a,n,!1,null,"7eeee175",null));e["default"]=C.exports},"2c7b":function(t,e,i){"use strict";var a=i("66f9"),n=i.n(a);n.a},"2fdb":function(t,e,i){"use strict";var a=i("5ca1"),n=i("d2c8"),r="includes";a(a.P+a.F*i("5147")(r),"String",{includes:function(t){return!!~n(this,t,r).indexOf(t,arguments.length>1?arguments[1]:void 0)}})},"301d":function(t,e,i){},"49ea":function(t,e,i){},5147:function(t,e,i){var a=i("2b4c")("match");t.exports=function(t){var e=/./;try{"/./"[t](e)}catch(i){try{return e[a]=!1,!"/./"[t](e)}catch(n){}}return!0}},"5dbc":function(t,e,i){var a=i("d3f4"),n=i("8b97").set;t.exports=function(t,e,i){var r,s=e.constructor;return s!==i&&"function"==typeof s&&(r=s.prototype)!==i.prototype&&a(r)&&n&&n(t,r),t}},"66f9":function(t,e,i){},6762:function(t,e,i){"use strict";var a=i("5ca1"),n=i("c366")(!0);a(a.P,"Array",{includes:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),i("9c6c")("includes")},6965:function(t,e,i){"use strict";var a=i("301d"),n=i.n(a);n.a},"6a3f":function(t,e,i){"use strict";var a=i("49ea"),n=i.n(a);n.a},7954:function(t,e,i){},"8b97":function(t,e,i){var a=i("d3f4"),n=i("cb7c"),r=function(t,e){if(n(t),!a(e)&&null!==e)throw TypeError(e+": can't set as prototype!")};t.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(t,e,a){try{a=i("9b43")(Function.call,i("11e9").f(Object.prototype,"__proto__").set,2),a(t,[]),e=!(t instanceof Array)}catch(n){e=!0}return function(t,i){return r(t,i),e?t.__proto__=i:a(t,i),t}}({},!1):void 0),check:r}},9093:function(t,e,i){var a=i("ce10"),n=i("e11e").concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return a(t,n)}},a481:function(t,e,i){"use strict";var a=i("cb7c"),n=i("4bf8"),r=i("9def"),s=i("4588"),o=i("0390"),l=i("5f1b"),c=Math.max,u=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,m=function(t){return void 0===t?t:String(t)};i("214f")("replace",2,function(t,e,i,g){return[function(a,n){var r=t(this),s=void 0==a?void 0:a[e];return void 0!==s?s.call(a,r,n):i.call(String(r),a,n)},function(t,e){var n=g(i,t,this,e);if(n.done)return n.value;var d=a(t),p=String(this),f="function"===typeof e;f||(e=String(e));var v=d.global;if(v){var b=d.unicode;d.lastIndex=0}var y=[];while(1){var _=l(d,p);if(null===_)break;if(y.push(_),!v)break;var w=String(_[0]);""===w&&(d.lastIndex=o(p,r(d.lastIndex),b))}for(var D="",j=0,x=0;x<y.length;x++){_=y[x];for(var S=String(_[0]),I=c(u(s(_.index),p.length),0),C=[],k=1;k<_.length;k++)C.push(m(_[k]));var L=_.groups;if(f){var $=[S].concat(C,I,p);void 0!==L&&$.push(L);var F=String(e.apply(void 0,$))}else F=h(S,p,I,C,L,e);I>=j&&(D+=p.slice(j,I)+F,j=I+S.length)}return D+p.slice(j)}];function h(t,e,a,r,s,o){var l=a+t.length,c=r.length,u=f;return void 0!==s&&(s=n(s),u=p),i.call(o,u,function(i,n){var o;switch(n.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,a);case"'":return e.slice(l);case"<":o=s[n.slice(1,-1)];break;default:var u=+n;if(0===u)return i;if(u>c){var p=d(u/10);return 0===p?i:p<=c?void 0===r[p-1]?n.charAt(1):r[p-1]+n.charAt(1):i}o=r[u-1]}return void 0===o?"":o})}})},aa77:function(t,e,i){var a=i("5ca1"),n=i("be13"),r=i("79e5"),s=i("fdef"),o="["+s+"]",l="​",c=RegExp("^"+o+o+"*"),u=RegExp(o+o+"*$"),d=function(t,e,i){var n={},o=r(function(){return!!s[t]()||l[t]()!=l}),c=n[t]=o?e(p):s[t];i&&(n[i]=c),a(a.P+a.F*o,"String",n)},p=d.trim=function(t,e){return t=String(n(t)),1&e&&(t=t.replace(c,"")),2&e&&(t=t.replace(u,"")),t};t.exports=d},ac6a:function(t,e,i){for(var a=i("cadf"),n=i("0d58"),r=i("2aba"),s=i("7726"),o=i("32e9"),l=i("84f2"),c=i("2b4c"),u=c("iterator"),d=c("toStringTag"),p=l.Array,f={CSSRuleList:!0,CSSStyleDeclaration:!1,CSSValueList:!1,ClientRectList:!1,DOMRectList:!1,DOMStringList:!1,DOMTokenList:!0,DataTransferItemList:!1,FileList:!1,HTMLAllCollection:!1,HTMLCollection:!1,HTMLFormElement:!1,HTMLSelectElement:!1,MediaList:!0,MimeTypeArray:!1,NamedNodeMap:!1,NodeList:!0,PaintRequestList:!1,Plugin:!1,PluginArray:!1,SVGLengthList:!1,SVGNumberList:!1,SVGPathSegList:!1,SVGPointList:!1,SVGStringList:!1,SVGTransformList:!1,SourceBufferList:!1,StyleSheetList:!0,TextTrackCueList:!1,TextTrackList:!1,TouchList:!1},m=n(f),g=0;g<m.length;g++){var h,v=m[g],b=f[v],y=s[v],_=y&&y.prototype;if(_&&(_[u]||o(_,u,p),_[d]||o(_,d,v),l[v]=p,b))for(h in a)_[h]||r(_,h,a[h],!0)}},c5f6:function(t,e,i){"use strict";var a=i("7726"),n=i("69a8"),r=i("2d95"),s=i("5dbc"),o=i("6a99"),l=i("79e5"),c=i("9093").f,u=i("11e9").f,d=i("86cc").f,p=i("aa77").trim,f="Number",m=a[f],g=m,h=m.prototype,v=r(i("2aeb")(h))==f,b="trim"in String.prototype,y=function(t){var e=o(t,!1);if("string"==typeof e&&e.length>2){e=b?e.trim():p(e,3);var i,a,n,r=e.charCodeAt(0);if(43===r||45===r){if(i=e.charCodeAt(2),88===i||120===i)return NaN}else if(48===r){switch(e.charCodeAt(1)){case 66:case 98:a=2,n=49;break;case 79:case 111:a=8,n=55;break;default:return+e}for(var s,l=e.slice(2),c=0,u=l.length;c<u;c++)if(s=l.charCodeAt(c),s<48||s>n)return NaN;return parseInt(l,a)}}return+e};if(!m(" 0o1")||!m("0b1")||m("+0x1")){m=function(t){var e=arguments.length<1?0:t,i=this;return i instanceof m&&(v?l(function(){h.valueOf.call(i)}):r(i)!=f)?s(new g(y(e)),i,m):y(e)};for(var _,w=i("9e1e")?c(g):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),D=0;w.length>D;D++)n(g,_=w[D])&&!n(m,_)&&d(m,_,u(g,_));m.prototype=h,h.constructor=m,i("2aba")(a,f,m)}},cd1c:function(t,e,i){var a=i("e853");t.exports=function(t,e){return new(a(t))(e)}},d2c8:function(t,e,i){var a=i("aae3"),n=i("be13");t.exports=function(t,e,i){if(a(e))throw TypeError("String#"+i+" doesn't accept regex!");return String(n(t))}},e1b8:function(t,e,i){},e853:function(t,e,i){var a=i("d3f4"),n=i("1169"),r=i("2b4c")("species");t.exports=function(t){var e;return n(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!n(e.prototype)||(e=void 0),a(e)&&(e=e[r],null===e&&(e=void 0))),void 0===e?Array:e}},ec4d:function(t,e,i){"use strict";var a=i("e1b8"),n=i.n(a);n.a},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}}]);
//# sourceMappingURL=chunk-7fa1737e.26c3204f.js.map